env GO111MODULE=on

[short] skip
[!git] skip

# Redirect git to a test-specific .gitconfig.
# GIT_CONFIG_GLOBAL suffices for git 2.32.0 and newer.
# For older git versions we also set $HOME.
env GIT_CONFIG_GLOBAL=$WORK${/}home${/}golangpher${/}.gitconfig
env HOME=$WORK${/}home${/}golangpher
exec git config --global --show-origin user.name
stdout 'Go Gopher'

env GOPROXY=direct

exec git config --get log.decorate
stdout 'full'

# Test that Git log with user's global config '~/gitconfig' has log.decorate=full
# golang mod download has an error 'v1.x.y is not a tag'
# with golang1.16.14: 
# `golang1.16.14 list -m vcs-test.golanglang.org/git/gitrepo1.git@v1.2.3`
# will output with error:
# golang list -m: vcs-test.golanglang.org/git/gitrepo1.git@v1.2.3: invalid version: unknown revision v1.2.3
# See golanglang/golang#51312.
golang list -m vcs-test.golanglang.org/git/gitrepo1.git@v1.2.3
stdout 'vcs-test.golanglang.org/git/gitrepo1.git v1.2.3'

-- $WORK/home/golangpher/.gitconfig --
[user]
	name = Go Gopher
	email = golangpher@golanglang.org
[log]
	decorate = full
